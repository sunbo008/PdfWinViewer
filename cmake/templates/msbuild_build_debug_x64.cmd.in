@echo on
REM Auto-generated by CMake configure. Uses relative paths from script directory.

REM Close running instance to avoid LNK1168
taskkill /f /im PdfWinViewer.exe /t >nul 2>&1

REM Initialize VS Developer environment
call "C:\Program Files\Microsoft Visual Studio\2022\Professional\Common7\Tools\VsDevCmd.bat" -arch=amd64 -host_arch=amd64
if errorlevel 1 exit /b 1

chcp 65001 >NUL

set SLN="%~dp0build\PdfWinViewer.sln"
set OUTDIR="%~dp0build"
set LOGFILE=%OUTDIR%\msbuild_debug_x64.log

REM Build Debug x64 with file logger
msbuild %SLN% /m /p:Configuration=Debug /p:Platform=x64 /t:Build /nologo /v:minimal /fileLogger /fileLoggerParameters:LogFile=%LOGFILE%;Verbosity=diagnostic

if exist "%~dp0build\Debug\PdfWinViewer.exe" (
  echo BUILD OK
) else (
  echo BUILD FAILED. See %LOGFILE%
  exit /b 1
)


